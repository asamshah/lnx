{% comment %}
  markup for lazyload library
  image {object} - the image object (not a url)
  {% render 'bgset', image: img_object %}
{% endcomment %}
{% liquid
  assign size_array = '180,360,440,540,720,900,1080,1296,1512,1728,1950,2100,2260,2450,2700,3000,3350,3750,4100' | split: ","
  unless aspect_ratio
    assign aspect_ratio = image.aspect_ratio
  else
    assign aspect_ratio = 1 | divided_by: aspect_ratio
  endunless
%}
{%- for width in size_array -%}
  {%- assign numwidth = width | plus: 0 -%}
  {%- if image.width > numwidth -%}
    {%- assign height = numwidth | divided_by: aspect_ratio -%}
    {{- image | image_url: width: numwidth, height: height, crop: 'top' }} {{ numwidth }}w {{ numwidth | divided_by: aspect_ratio | round -}}h,
  {%- endif -%}
{%- endfor -%}
{% comment %}
{%- if image.width != blank -%}
    {% if image.width > 180 %}{{ image | image_url: width: 180, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 180w {{ 180 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 360 %}{{ image | image_url: width: 360, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 360w {{ 360 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 540 %}{{ image | image_url: width: 540, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 540w {{ 540 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 720 %}{{ image | image_url: width: 720, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 720w {{ 720 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 900 %}{{ image | image_url: width: 900, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 900w {{ 900 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 1080 %}{{ image | image_url: width: 1080, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 1080w {{ 1080 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 1296 %}{{ image | image_url: width: 1296, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 1296w {{ 1296 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 1512 %}{{ image | image_url: width: 1512, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 1512w {{ 1512 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 1728 %}{{ image | image_url: width: 1728, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 1728w {{ 1728 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 1950 %}{{ image | image_url: width: 1950, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 1950w {{ 1950 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 2100 %}{{ image | image_url: width: 2100, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 2100w {{ 2100 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 2260 %}{{ image | image_url: width: 2260, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 2260w {{ 2260 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 2450 %}{{ image | image_url: width: 2450, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 2450w {{ 2450 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 2700 %}{{ image | image_url: width: 2700, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 2700w {{ 2700 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 3000 %}{{ image | image_url: width: 3000, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 3000w {{ 3000 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 3350 %}{{ image | image_url: width: 3350, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 3350w {{ 3350 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 3750 %}{{ image | image_url: width: 3750, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 3750w {{ 3750 | divided_by: aspect_ratio | round }}h,{% endif %}
    {% if image.width > 4100 %}{{ image | image_url: width: 4100, height: image.width | divided_by: aspect_ratio, crop: 'top' }} 4100w {{ 4100 | divided_by: aspect_ratio | round }}h,{% endif %}
    {{ image | image_url }} {{ image.width }}w {{ image.height }}h
{%- else -%}
    {{ image }}
{%- endif -%}
{% endcomment %}
